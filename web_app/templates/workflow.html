{% extends "base2.html" %}
{% block title %}Gaggle Workspace - Welcome{% endblock %}
{% block content %}
{% load static %}
<div class="sub-page">
<div class="main" style="width: 97%">
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/redmond/jquery-ui.css" />
<link rel="stylesheet" href="{{STATIC_PREFIX}}stylesheets/colorbox.css" />
<link type="text/css" rel="stylesheet" href="{{STATIC_PREFIX}}stylesheets/jquery.dropdown.css" />
<link rel="stylesheet" href="{{STATIC_PREFIX}}stylesheets/portal-style.css">
<link rel="stylesheet" href="{{STATIC_PREFIX}}stylesheets/jquery.reject.css">

<script src="http://www.java.com/js/deployJava.js"></script>
<script type='text/javascript' src='{{STATIC_PREFIX}}javascripts/jquery.jsPlumb-1.3.16-all.js'></script>
<script type='text/javascript' src='{{STATIC_PREFIX}}javascripts/jquery.colorbox.js'></script>
<script type="text/javascript" src="{{STATIC_PREFIX}}javascripts/workflow.js"></script>
<script type="text/javascript" src="{{STATIC_PREFIX}}javascripts/scripthandler.js"></script>
<script type="text/javascript" src="{{STATIC_PREFIX}}javascripts/jquery.jeditable.js"></script>
<script type="text/javascript" src="{{STATIC_PREFIX}}javascripts/jquery.dropdown.js"></script>
<script type="text/javascript" src="{{STATIC_PREFIX}}javascripts/jquery.reject.min.js"></script>
<div id="container" style="width: 100%">
<!--<img align="right" width="40px" src="{{STATIC_PREFIX}}images/workflow_logo.png"> -->

<div class="componentheader">
    <h5> Gaggle Workspace&nbsp;&nbsp;&nbsp;<label id="lblLoginWarning" class="lblWarning">Please login to take full advantage of the Gaggle Workspace!</label></h5>
</div>
<a class="componenthelp" align="right" href="#inlineworkspacehelp">
    <img src="/static/images/help.png" />
</a>
<br/>
<a class="small red awesome" style="visibility: hidden" href='javascript:StartBoss()' title="First start Gaggle Boss">Start Boss</a>
<div id="tabs" class="sub-page ui-tabs ui-widget ui-widget-content ui-corner-all">
<ul>
    <li><a class="name" href="#tab-data">Dataspace -></a></li>
    <li><a class="network" href="#tab-workflow">Workflows -></a></li>
    <li><a class="regulator" href="#tab-states">Saved States -></a></li>
    <li><a class="regulator" href="#tab-reports">Reports -> </a></li>
    <li><a class="motif" href="#tab-history">History</a></li>
    <li><a class="motif" href="#tab-log">Log</a></li>
</ul>
    <div id="tab-data">
        <div class="main" style="width:70%">
            <h5>Data Files&nbsp;&nbsp;<label>(Use <a href="http://gaggle.systemsbiology.net/docs/geese/firegoose/install/">Firegoose</a> to capture and save data in the Dataspace)</label></h5>
            <font color="Blue">Select an organism from the portal to see available data:</font>
            <select id="organismSelect" onchange="javascript:organismSelected(this);">
                <option value = "" selected>Select an organism</option>
                {% for organism in organisms %}
                {% if organism.name != "Generic"  %}
                <option value="{{organism.short_name}}">{{organism.name}} | {{organism.short_name}}</option>
                {% endif %}
                {% endfor %}
            </select>
            <table id="tblNetworkPortalFiles"><caption style="font-size: 10pt;"> Network Portal Files - <a id='ahrefNPSelectAll' href="javascript:SelectAllData('#tblNetworkPortalFiles', '#ahrefNPSelectAll')">Select All</a> | <a href="javascript:GroupData('#tblNetworkPortalFiles');">Group</a> | <a href="javascript:DeleteCollectedData('#tblNetworkPortalFiles', true);">Delete</a> | <a href="javascript:DeleteCollectedData('#tblNetworkPortalFiles', false);">Delete Unselected</a></caption>
                <tbody>
                <th style="width:30%">Name</th><th style="width:30%">Type</th><th style="width:40%"> Description</th><th style="width:50%">Operations</th>
                </tbody>
            </table>
            <p>
            <table id="tblUserFiles"><caption style="font-size: 10pt;"> User Files - <font color="red"><a href="javascript:UploadDataFiles();">Upload Data</a> </font>| <a id='ahrefUserSelectAll' href="javascript:SelectAllData('#tblUserFiles', '#ahrefUserSelectAll')">Select All</a> | <a href="javascript:GroupData('#tblUserFiles');">Group</a> | <a href="javascript:GroupOpen('#tblUserFiles');">Open</a> | <a href="javascript:SaveCollectedData();">Save</a> | <a href="javascript:DeleteCollectedData('#tblUserFiles', true);">Delete</a> | <a href="javascript:DeleteCollectedData('#tblUserFiles', false);">Delete Unselected</a></caption>
                <tbody>
                <th style="width:30%">Name</th><th style="width:30%">Type</th><th style="width:40%"> Description</th><th style="width:50%">Operations</th>
                </tbody>
            </table>
            <!--<input type="button" id="btnBatchRun" value="Batch Run" onclick="javascript:BatchRun();" class="button"/>
            <select id="selectDataAppliedHistory" class="selectDataAppliedHistory">
                <option value="-1">Select a data application record to apply to the workflow</option>
                <option value="-2">---------------------------------------</option>
            </select> -->
        </div>
        <div id="sidebar" class="sidebar" style="width:25%"><h5> My Groups</h5>
            <div id="wfgrpaccordion" class="datagroupaccordion">
                {% for datagroup in datagroups %}
                <p id='agrp_{{datagroup.ID|stringformat:"i"}}'>{{datagroup.Name}}</p>
                <div id='divgrp_{{datagroup.ID|stringformat:"i"}}' class="datagrpdivclass">
                    <div>{{datagroupentry.Description}}</div>
                    <ul>
                        {% for content in datagroup.Contents %}
                        <li>
                            <input type="checkbox" />
                            <a href="{{content.dataurl}}">{{content.urltext}}</a>
                            <input type="hidden" value='{{content.id|stringformat:"i"}}' />
                        </li>
                        {% endfor %}
                    </ul>
                    <input type="hidden" value='{{datagroup.ID|stringformat:"i"}}' />
                    <input type="hidden" value="{{datagroup.Name}}" />
                    <input type="hidden" value='{{datagroup.ID|stringformat:"i"}}' />
                    <input type="button" value="Select All" class="button" onclick="javascript:SelectAllInGroup(this);" />
                    <input type="button" value="Open" class="button" onclick="javascript:OpenOneGroup(this);" />
                    <input type="button" value="Save" class="button" onclick="javascript:SaveOneGroup(this);" />
                    <input type="button" value="Delete Group" class="button" onclick="javascript:DeleteOneGroup(this);" />
                    <input type="button" value="Delete Selected" class="button" onclick="javascript:DeleteDataInGroup(this);" />
                    <input type="button" value="Delete Unselected" class="button" onclick="javascript:DeleteDataInGroup(this);" />
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div id="tab-workflow">
        <div class="sub-page">
        <h5> Gaggle Workflow</h5>

        <!-- <table width="100%">
            <tbody>
            <tr>
                <th>Start Here <img align="right" width="25px" src="{{ STATIC_PREFIX }}images/Redo.png"></th>
                <th><span class="small blue fancybutton">1</span>&nbsp; <a class="small red awesome" href='/static/jnlp/boss.jnlp' title="First start Gaggle Boss">Start Boss</a> </th>
                <th><span class="small blue fancybutton">2</span>&nbsp; Add and connect workflow modules </th>

                <th> <span class="small blue fancybutton">4</span>&nbsp; <input type="button" value="Run Workflow" onclick="SubmitWorkflow()" class="small green awesome" title="Run selected workflow"/></th>
                <th><a class="componenthelp" href="#quickhelp"><img src="/static/images/question.gif" /></a></th>
            </tr>
            </tbody>
        </table> -->
        <table id="tblWorkflow" class="tblWorkflow">
            <tbody>
            <tr>
                <th style="width: 15%">
                    <div>
                        <div class="componentheader"><h3>Modules</h3></div>
                        <a class="componenthelp" href="#inlinecomponenthelp">
                            <img src="/static/images/help.png" />
                        </a>
                    </div>
                </th>
                <th style="width: 65%">
                    <!--<span id="boss"  class="boss"><a href='/static/jnlp/boss.jnlp' title="First start Gaggle Boss">start Gaggle boss</a></span>-->
                    <input type="button" value="Run" onclick="SubmitWorkflow(null, 'Submit workflow')" class="button-run" title="Run selected workflow"/>
                    <input type="button" value="Save" onclick="SaveClicked()" class="button" title="Save or edit current workflow"/>
                    <input type="button" value="Delete" onclick="DeleteClicked()" class="button" title="Delete current workflow"/>
                    <input type="button" value="Clear" onclick="InitializeWorkflow()" class="button" title="Clear workflow canvas"/>
                    <input id="btnRecord" type="button" value="Record" onclick="ToggleRecording()" class="button-record" title="Start recording new workflow"/>
                    <input id="btnPause" type="button" value="Pause" onclick="TogglePause()" class="button-record" title="Pause workflow recording"/>

                </th>
                <th style="width: 20%">
                    <div>
                        <div class="componentheader"><h3>Workflows</h3></div>
                        <a class="componenthelp" href="#workflowshelp">
                            <img src="/static/images/help.png" />
                        </a>
                    </div>
                </th>
            </tr>
            <!--<tr>
                <td></td>
                <td>
                            <select id="organismSelect" onchange="javascript:organismSelected(this);">
                            <option value = "" selected>Select an organism for the workflow</option>
                            <option value="bce">Bacillus cereus ATCC14579 | bce</option>
                            <option value="bsu">Bacillus subtilis | bsu</option>
                            <option value="bth">Bacteroides thetaiotaomicron VPI-5482 | bth</option>
                            <option value="cje">Campylobacter jejuni | cje</option>
                            <option value="cac">Clostridium acetobutylicum | cac</option>
                            <option value="eco">Escherichia coli K12 | eco</option>
                            <option value="gsu">Geobacter sulfurreducens | gsu</option>
                            <option value="hal">Halobacterium salinarum NRC-1 | hal</option>
                            <option value="mmp">Methanococcus maripaludis S2 | mmp</option>
                            <option value="pae">Pseudomonas aeruginosa | pae</option>
                            <option value="rsp">Rhodobacter sphaeroides 2.4.1 | rsp</option>
                            <option value="syf">Synechococcus elongatus PCC 7942 | syf</option>
                        </select>


                </td>
                <td></td>
            </tr>-->
            <tr>
                <td valign="top" style="width: 15%">
                    <div id="components" class="divcomponents">
                        {% if wfentries.count > 0 %}
                        {% for wfentry in wfentries %}
                        <p id="categorypara_{{wfentry.Category.id}}"><strong>{{wfentry.Category.name}}</strong></p>

                        {% for component in wfentry.WorkflowComponents %}
                        <!--<div style="width: 100%; postion: relative"> -->
                            <!--<div style="display: inline; width: 20px; margin: 10px"><input type="checkbox" /></div> -->
                            <div class="component" id='component_{{component.Component.id|stringformat:"i"}}'>
                                <div class="componenttitle"><a href="javascript:startDownload('{{component.Component.downloadurl}}')">{{component.Component.short_name}}</a>
                                </div>
                                <img src="/static/images/close.png" class="componentclose" title="Remove from workflow"></img>
                                <input class="componentchildinput" type="text" value="{{component.Component.serviceurl}}" placeholder="Enter the url or path to the executable of the component" title="Enter the url or path to the executable of the component" />
                                <a class="componentquestion" href="#inlinewfpath">
                                    <img src="/static/images/help.png" />
                                </a>
                                <!--<input class="componentchildinput" type="text" placeholder="Enter subaction"
                      title="Enter subaction (for example, a web handler for firegoose)" value=""/> -->
                                <select class="componentsubactions">
                                    {% for subaction in component.Subactions %}
                                    <option value="{{subaction.url}}">{{subaction.name}}</option>
                                    {% endfor %}
                                </select>
                                <input class="componentchildinput" type="text" placeholder="Enter data url"
                                       title="Enter the url of data to be opened by the component" value=""/>
                                <input type="hidden" value="{{component.Component.name}}" />
                                <input type="hidden" value="{{component.Component.short_name}}" />
                                <input type="hidden" value="" />
                                <input class="componentchildinput" type="text" value="{{component.Component.arguments}}"
                                       placeholder="Enter the arguments to be passed to the component"
                                       title="Enter the arguments to be passed to the component"/>
                                <input type="hidden" value="" />
                                <input type="hidden" value="0" />
                                <input type="hidden" value="{{component.Component.name}}" />
                                <input type="hidden" value="{{component.Component.isscript}}" />
                                <input type="hidden" value="{{component.Component.id|stringformat:'i'}}" />
                                <input type="hidden" value="{{component.Component.downloadurl}}" />
                                <select class="componenttemplates">
                                    {% for template in component.Templates %}
                                    <option value="{{template.file}}">{{template.name}}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        <!--</div> -->
                        {% endfor %}

                        {% endfor %}
                        {% endif %}
                    </div>
                    <br />
                    <input type="button" value="Create" onclick="CreateNewWorkflowModule()" />
                    <!--<input type="button" value="Delete" onclick="RemoveWorkflowModule()" /> -->
                </td>
                <td valign="top" style="width: 65%"><h3>Workflow Canvas</h3>
                    <div id="workflowcanvas" class="workflowcanvas" >
                        <div><span class="search_help">This is your workflow canvas. Start adding workflow components from the left, open a saved workflow or read our <a class="componenthelp" href="#quickhelp">quick start guide.</a></span></div>
                        <div style="display:none">
                            <div id="quickhelp" style="text-align:left">
                                <h2>Workflow Help</h2>
                                <h5>Quick Start Guide</h5>
                                <p><span class="small blue fancybutton">1</span>&nbsp; Start the Gaggle Boss by clicking on the <span class="small red awesome">Start the Boss</span> link and click on the "Gaggle" link in the firegoose toolbar to connect to Gaggle.</p>
                                <p><span class="small blue fancybutton">2</span>&nbsp; Add workflow modules from left sidebar and connect them.</p>
                                <p><span class="small blue fancybutton">3</span>&nbsp; Select an organism to analyze if you would like to use Network Portal organisms in your workflow. This will automatically create necessary attributes specific for the selected organism. Otherwise you can leave this field unselected and enter your custom specifications for each module.</p>
                                <p><span class="small blue fancybutton">4</span>&nbsp; Click <span class="small green awesome">"Run"</span> to start the workflow</li> </p>

                                <h5> Running custom workflows</h5>
                                <p>If you would like to use your own cytoscape or mev files it is possible to create custom workflows. For the initial setup you will need to download and install custom workflow modules.
                                <p><span class="small blue fancybutton">1</span>&nbsp; Install each goose by using the links on the left (if this is your first time). This will download the updated goose.</p>
                                <p><span class="small blue fancybutton">2</span>&nbsp; Start the Gaggle Boss by clicking on the <span class="small red awesome">Start the Boss</span> link</p>
                                <p><span class="small blue fancybutton">3</span>&nbsp; Click on the Gaggle toolbar in Firefox and <b>Connect to Gaggle</b></p>
                                <p><span class="small blue fancybutton">4</span>&nbsp; Drag and drop the goose you want into your workflow canvas</p>
                                <p><span class="small blue fancybutton">5</span>&nbsp; For each module (except firegoose),  workflow will automatically capture path to the executable file in your computer if you open the module (cytoscape or mev) after the gaggle boss has already started.Alternatively, "Enter the url of the executable in your computer"
                                    e.g for cytoscape: "C:\Program Files\Cytoscape_v2.8.3\Cytoscape.exe" in Windows or "/Applications/Cytoscape_v2.8.3" in Mac OSX. </p>
                                <p><span class="small blue fancybutton">6</span>&nbsp; Select any subactions for your modules from the dropdown menu.</p>
                                <p><span class="small blue fancybutton">7</span>&nbsp; If your workflow requires additional files, enter path to data files in your desktop or on the web. For example, this could be link to the expression file in your desktop or web.</p>
                                <p><span class="small blue fancybutton">8</span>&nbsp; In order to connect to components in the workflow drag the circle from the input goose to square of the next workflow component</p>
                                <p><span class="small blue fancybutton">9</span>&nbsp; Save your workflow </p>

                                <h5> Running the Workflow</h5>
                                <p><span class="small blue fancybutton">1</span>&nbsp; Create a new workflow or open a saved one</p>
                                <p><span class="small blue fancybutton">2</span>&nbsp; Click <span class="small green awesome">"Run"</span> to start the workflow</p>
                                <p><span class="small blue fancybutton">3</span>&nbsp; For Firegoose, this will open a new tab and will take you to the page you specified in your workflow</p>
                                <p><span class="small blue fancybutton">4</span>&nbsp; Select the type of the data you want for the next component from the Firegoose toolbar and select "Next"</p>
                                <p><span class="small blue fancybutton">5</span>&nbsp; Your data will be broadcast to the next component in your workflow and your next application or webpage will be opened.</p>
                                <p><span class="small blue fancybutton">6</span>&nbsp; For each workflow component you need to select specific data and click "Next"</p>

                                <h5> Recording the Workflow</h5>
                                <p><span class="small blue fancybutton">1</span>&nbsp; Gaggle can follow your actions and record them into your workflow for automated tasks</p>
                                <p><span class="small blue fancybutton">2</span>&nbsp; Before recording make sure that the Gaggle bos has started</p>
                                <p><span class="small blue fancybutton">3</span>&nbsp; Click on <span class="small awesome">"Record"</span> button to start recording</p>
                                <p><span class="small blue fancybutton">4</span>&nbsp; Create workflow and follow the steps to complete your analysis</p>
                                <p><span class="small blue fancybutton">5</span>&nbsp; Go back to your workspace and <span class="small awesome">"Stop"</span> your recording Once you are done</p>
                                <p><span class="small blue fancybutton">6</span>&nbsp; Workflow components and connections will be automatically created and placed into your workspace.</p>
                                <p><span class="small blue fancybutton">7</span>&nbsp; You can <span class="small awesome">"Pause"</span> workflow anytime</p>
                                <h4><a href="/static/apidocuments/index.html">API documents</a> for developing Boss and Goose that supports workflow</h4>
                            </div>
                        </div>

                </td>
                <td class="tdlistworkflow" valign="top">

                    <div id="accordion" class="workflowaccordion">
                        {% for workflow in myworkflows %}
                        <p id='h3wf_{{workflow.id|stringformat:"i"}}'><a href='#' id='liwf_{{workflow.id|stringformat:"i"}}'>{{workflow.name}}</a></p>
                        <div id='divwf_{{workflow.id|stringformat:"i"}}'>
                            <p>{{workflow.description}}</p>
                        </div>
                        {% endfor %}
                    </div>


                    <!--<div id="divWorkflow" class="divWorkflow">
                   <ul>
                   {% if myworkflows.count > 0 %}
                       {% for workflow in myworkflows %}
                           <li class="unselectedworkflow" id='liwf_{{workflow.id|stringformat:"i"}}'><a title="{{workflow.description}}" href='javascript:GetWorkflow("{{workflow.id|stringformat:"i"}}")'>{{workflow.name}}</a></li>
                       {% endfor %}
                   {% endif %}
                   </ul>
                   </div> -->


                    <!--<div><H3> Reports</H3>
                        <input type="button" value="Delete" onclick="DeleteSessionReport()" class="button"/>
                    </div>
                    <br />
                    <div id="divReport" class="divWorkflow">
                        <ul></ul>
                    </div> -->

                </td>
            </tr>
            </tbody>
        </table>
        </div>

        <p id="result"></p>

        <div id="dlgsaveworkflow" class="dlgsaveworkflow" title="Save Workflow">
            <p>Name: <input type="text" /></p>
            <p>Description: <input type="text" /></p>
            <p><input type="checkbox"/>Save as a new workflow</p>
        </div>

        <div id="dlgauthenticationalert" class="dlgauthenticationalert" title="Warning">
            <p>Do you want to login and save the workflow?</p>
        </div>

        <div id="dlgdeletealert" class="dlgauthenticationalert" title="Warning">
            <p>Do you really want to delete the workflow?</p>
        </div>

        <div id="dlgnodataapplicationalert" class="dlgauthenticationalert" title="Warning">
            <p>You haven't selected a data application method. Do you want to proceed?</p>
        </div>

        <div id="dlgworkflowfinished" class="dlgauthenticationalert" title="Continue Batch Run">
            <p>Workflow finished. Do you want to execute the next one in the batch?</p>
            <p><input type="checkbox"/>Do not ask for this batch</p>
        </div>

        <input id="authenticated" type="hidden" value="{{userid}}" />
        <input id="componentstring" type="hidden" value="{{componentstring}}" />

        <div style="display:none">
            <div id='inlinewfpath' style='padding:10px; background:#fff'>
                <h5>Configure the Path of Gaggle Geese Applications</h5>
                <p align="left">There are two ways to configure the execution path of a goose:</p>
                <p align="justify">&nbsp;&nbsp;&nbsp;&nbsp;If you already know the path of the goose (e.g for cytoscape: "C:\Program Files\Cytoscape_v2.8.3\Cytoscape.exe" in Windows or "/Applications/Cytoscape_v2.8.3" in Mac OSX),
                    simply add the path to the input field.</p>
                <p align="justify">&nbsp;&nbsp;&nbsp;&nbsp;Alternatively, Gaggle can automatically detect the path for you. Here is how it works: First, click the "Start Gaggle boss" button to start the boss. Next, start the goose application and connect to the boss.
                    (most geese connect to boss automatically. MeV, however, needs to be connected manually) and that's it!
                    The Gaggle boss will remember the paths for ALL the workflows.</p>
            </div>
        </div>

        <div style="display:none">
            <div id='inlinecomponenthelp' style='padding:10px; background:#fff'>
                <h5>How to Build a Workflow</h5>
                <p align="justify"><strong>Important:</strong> Go to the <a href="http://www.java.com/en/download/testjava.jsp">Java Test Page</a> and verify that the version of your Java is at least Java SE 6 (or 1.6).</p>
                <p align="justify">
                    1. Install each goose by clicking the on the name of the goose in the "Modules" column. (If this is your first time).
                    This will download the updated goose. You will need to install them for your application
                </p>
                <p align="justify">
                    2. <strong>Drag the box corresponding to the goose you want in your workflow and drop into the Workflow canvas.</strong>
                </p>
                <p align="justify">
                    3. For each goose "Enter the url of the executable in your computer"
                    e.g for cytoscape: "C:\Program Files\Cytoscape_v2.8.3\Cytoscape.exe" in Windows or "/Applications/Cytoscape_v2.8.3/Cytoscape" in Mac OSX
                </p>
                <p align="justify">
                    4. Select any subactions or data you want to open.
                </p>
                <p align="justify">
                    5. Input the url (or path) to the data file to be opened by a the component.
                </p>
                <p align="justify">
                    6. In order to connect to components in the workflow <strong>drag the circle from the input goose to square of next workflow component.</strong>
                </p>
                <p align="justify">
                    7. Save your workflow.
                </p>
                </ul>
                </p>
            </div>
        </div>

        <div style="display:none">
            <div id='workflowshelp' style='background:#fff'>
                <H5>Saved Workflows</H5>
                <p>You can save workflows into your personal workspace if you are logged in or you can save them into public workspace.
                    Please remember that public workflows can be edited/deleted by others.</p>
                <p> It is a good practise to provide a descriptive text for the workflow for future reference.</p>
                <p> Clicking on the workflow title will bring workflow components into the canvas and will also list associated reports under the reports section.</p>
            </div>
        </div>

        <div id="divDataspaceMenu" style="display: none">
            <ul id="ulctxgoosenames">
            </ul>

        </div>

        <div id="divDataspaceComponentMenu" style="display: none">
            <strong>Open in an Existing Goose</strong><br/>
            <ul id="ulctxExistingComponents">
            </ul>
            <hr />
            <strong>Open in a New Goose</strong><br/>
            <!--<strong>Select an Application</strong><br/>-->
            <ul id="ulctxcomponents">
            </ul>
            <hr />
            <p>
                <strong>Select a broadcast type</strong>
                <a class="componenthelp" href="#inlinebroadcastdatatype">
                    <img style="vertical-align:middle" src="/static/images/help.png" />
                </a>
            </p>

            <p><input id="inputNameValue" type="radio" name="PassData" checked="true"/>NameList
            <input id="inputUrlValue" type="radio" name="PassData" />File</p>
            <input id="inputContextSubaction" type="hidden" value="" />
        </div>

        <div id="divDataspaceGroup" style="display: none">
            <p>Group Name: <input type="text" /></p>
            <p>Description: <input type="text" /></p>
            <p><input id="chkSaveGroup" type="checkbox" checked/>Save the Group</p>
        </div>

        <div id="dlgUploadData" style="display:none" title="Upload Data">
            <!--<p><label id="labelOrganism"></label></p> -->
            <select id="selectUploadDataOrganism">
                <option value = "" selected>Select an organism</option>
                {% for organism in organisms %}
                {% if organism.name != "Generic"  %}
                <option value="{{organism.short_name}}">{{organism.name}} | {{organism.short_name}}</option>
                {% endif %}
                {% endfor %}
            </select>
            <div id="uploadDataTabs">
                <ul>
                    <li><a href="#datatabs-1">Files</a></li>
                    <li><a href="#datatabs-2">URLs</a></li>
                </ul>
                <!--<div style="margin-left: 370px">
                    <a class="componenthelp" align="right" href="#inlineuploadfilehelp">
                        <img src="/static/images/help.png" />
                    </a>
                </div>
                <br /> -->
                <div id="datatabs-1" style="width: 460px; float: left">
                    <form method="post" enctype="multipart/form-data">
                        <input name='uploads[]' id="filesToUpload" type="file" multiple><br />
                        Description: <input id="uploadFileDescription" type="text" id='inputFileDesc' />
                    </form>
                    <br />
                    <p>
                        {% for datatype in organismdatatypes %}
                        {% if datatype.type == "Generic" %}
                        <input type="radio" name="dataType" value="{{datatype.type}}" checked>{{datatype.type}}
                        {% else %}
                        <input type="radio" name="dataType" value="{{datatype.type}}">{{datatype.type}}
                        {% endif %}
                        {% endfor %}
                    </p>
                </div>
                <div id="datatabs-2">
                    URLs (seperated by semicolon): <input id="inputURLs"><br />
                    Description: <input id="uploadURLDescription" type="text" id='inputURLDesc' /><br />
                    <p>
                        {% for datatype in organismdatatypes %}
                        {% if datatype.type == "Generic" %}
                        <input type="radio" name="urlDataType" value="{{datatype.type}}" checked>{{datatype.type}}
                        {% else %}
                        <input type="radio" name="urlDataType" value="{{datatype.type}}">{{datatype.type}}
                        {% endif %}
                        {% endfor %}
                    </p>
                </div>

            </div>

        </div>

        <div id="dlgEditData" style="display:none" title="Edit Data">
            <p><label id="labelTargetData"></label></p>
            <select id="selectEditDataOrganism">
                <option value = "" selected>Select an organism</option>
                {% for organism in organisms %}
                {% if organism.name != "Generic"  %}
                <option value="{{organism.short_name}}">{{organism.name}} | {{organism.short_name}}</option>
                {% endif %}
                {% endfor %}
            </select>
            <br />
            Description: <input id="inputEditDataDesc" type="text" />
            <p>
                {% for datatype in organismdatatypes %}
                <input type="radio" id="radioEditDataType_{{datatype.type}}" name="editDataType" value="{{datatype.type}}">{{datatype.type}}
                {% endfor %}
            </p>
        </div>

        <div id="dlgUploadModule" style="display:none" title="Upload Module">
            <form method="post" enctype="multipart/form-data">
                Name: <input type="text" id='inputModuleName' /><br/>
                Abbreviation: <input type="text" id='inputModuleShortName' /><br/>
                Description: <input type="text" id='inputModuleDesc' /><br/><br/>

                <select id="selectModuleCategory">
                    <option value = "0" selected>Select a category for the component</option>
                    {% for wfentry in wfentries %}
                    <option value = "{{wfentry.Category.id|stringformat:'i'}}">{{wfentry.Category.name}}</option>
                    {% endfor %}
                </select><br />

                <select id="selectModuleApplication">
                    <option value = "-1" selected>Select an application if applicable</option>
                </select><br />

                File: <input name='uploads[]' id="moduleToUpload" type="file"><br />
                Function Name: <input type="text" id="inputModuleScriptName" /><br />

                <div id="divArguments">

                </div>

                <div id="divTemplates">
                    <label>Template:&nbsp;</label><input name="uploads[]" id="inputTemplateFiles" type='file' multiple/>
                </div>
                <p><input id="inputModulePrivate" type="radio" name="SharedModule" checked="true" value="Private"/>Private
                    <input id="inputModuleShared" type="radio" name="SharedModule" value="Shared" />Shared</p>
            </form>
        </div>

        <div id="dlgModuleParameters" style="display:none" title="Module Parameters">
            <ul id="ulParameters">

            </ul>
        </div>


        <div style="display:none">
            <div id='inlineworkspacehelp' style='padding:10px; background:#fff'>
                <h5>The Gaggle Workspace</h5>
                <p align="justify"><strong>Important:</strong> Go to the <a href="http://www.java.com/en/download/testjava.jsp">Java Test Page</a> and verify that the version of your Java is at least Java SE 6 (or 1.6).</p>
                <p align="justify">
                    The Gaggle Workspace Page consists of the following tabs:<br />
                    1. <strong>The Dataspace Tab</strong>. User can capture data using <a href="http://gaggle.systemsbiology.net/docs/geese/firegoose/">Firegoose</a> from heterogenous webpages (tutorial video
                    <a href="http://www.youtube.com/watch?v=Z93VKagR6os">here</a>) or local files for
                    cloud-based organization and storage of raw and processed data (tutorial video <a href="http://www.youtube.com/watch?v=XrZMnaTLW0A">here</a>).
                    All the data is displayed in the Dataspace tab.
                </p>
                <p align="justify">
                    You should first select an organism from the "select organism" dropdown list. Data related to the selected organism will be displayed
                    in two tables. First, the <strong>Network Portal Files Table</strong>. These files are automatically generated by the Network Portal. Usually
                    they are Cytoscape network files and MeV analysis files. Second, <strong>the User Data Table</strong>. Users can upload any data related to the
                    species and the files will be stored on the server. A video tutorial of uploading and organizing data can be found <a href="https://www.youtube.com/watch?v=_nTjVHS26nw">here</a>.
                    For each file, users can select from a list of actions from the dropdown list
                    on each row of the tables to open, edit, and download the data file. Users can also select multiple data files and use the
                    links on top of the table to save, delete, or group data. <strong>Tutorials</strong> can be found <a href="http://www.youtube.com/watch?v=K9ojLoqbRSI">here</a>.
                </p>
                <p align="justify">
                    In particular, users can group data by checking the checkboxes in the table and clicking the "Group" link on top of the tables.
                    The newly generated group will be displayed in the <strong>"My Group"</strong> list on the right-hand side of the page. Users can select to open some
                    or all the data in a group.
                </p>
                <p align="justify">
                    2. <strong>The Workflow Tab</strong>. The system automatically records data communication between various applications and generates
                    workflows.  Users can also manually create workflows by dragging and dropping workflow components to the canvas and
                    connecting them to indicate directions of data communications. Users can save and rerun workflows on different data sets.
                    A video tutorial can be viewed <a href="http://www.youtube.com/watch?v=EwEC0WL9BKg">here</a>.
                </p>
                <p align="justify">
                    3. <strong>The Save State Tab</strong>. It allows users to save the state of all open websites and desktop applications
                    and reload the session later from any machine. A tutorial video can be found <a href="https://www.youtube.com/watch?v=66auEXlPFBE">here</a>.
                </p>
                <p align="justify">
                    4. <strong>The Session Reports Tab</strong>. Reports are automatically generated for workflows. A report consists of
                    snapshots of each applications of the workflow after the workflow is finished. A video tutorial is <a href="http://www.youtube.com/watch?v=Rk3Bv2vochA">here</a>.
                </p>
                <p align="justify">
                    5. <strong>The History Tab</strong>. The page records the actions (e.g., open a data file, save/load states, etc.) triggered by users.
                </p>
                <p align="justify">
                    6. <strong>The Log Tab</strong>. The page contains debugging information. Users can send debugging information to us if they encounter
                    problems.
                </p>
                <p align="justify">
                    7. An <a href="http://networks.systemsbiology.net/static/apidocuments/">open API</a> for community development.
                </p>
                </ul>
                </p>
            </div>
        </div>

        <div style="display:none">
            <div id='inlineuploadfilehelp' style='padding:10px; background:#fff'>
                <h5>How to Upload File to the Workspace</h5>
                <p align="justify">
                    1. Select the target organism for which the files you want to upload. <strong>If you want the files to be
                    available for all organisms, don't select any organism.</strong>
                </p>
                <p align="justify">
                    2. Click the "Browse" button and select one or more files you want to upload.
                </p>
                <p align="justify">
                    3. Type additional information in the "Description" box.
                </p>
                <p align="justify">
                    4. Select the type of files (MeV, Cytoscape, Generic) you are uploading. Later on, the files will be automatically opened by
                    their associated applications if possible.  For example, suppose you select "Mev Analysis File" as the type of a file,
                    later on when you select the "Open" action in the User File table, MeV will be started automatically and the file will be opened.
                </p>
                <p align="justify">
                    5. You can upload application specific files as well as text(.txt) files that contain lists of genes. MeV files (.tsv) should look like
                    the following:
                </p>
                <p align="justify">
                    <img src="/static/images/mev-datafile.jpg" /><br />
                    Notice that the first column contains the gene names and the first row contains the name of the log ratios.
                </p>
                <p align="justify">
                    The text file include a list of genes. It should look like this:<br/>
                    <img align="left" src="/static/images/workspace-textfile.jpg" />
                </p>
                </ul>
                </p>
            </div>
        </div>

        <div style="display:none">
            <div id='inlinesavestatehelp' style='padding:10px; background:#fff'>
                <h5>Save/Load States</h5>
                <p align="justify">
                    Users can save and load states. After clicking the "Save State" button, the Boss contacts each geese to
                    save their current states (e.g., all the tabs opened in Firefox, and the associated gaggle data, all the
                    networks opened in Cytoscape, all the expression files opened in MeV etc).
                </p>
                <p align="justify">
                    It generally takes about half to one minute to save the state. Once the state is saved, a new row will appear
                    in the saved states table.
                </p>
                <p align="justify">
                    User can edit, delete, and load the saved states. After user clicks the "load" button, all the applications
                    corresponding to the state will be automatically started and the state data will be loaded.
                </p>
                <p align="justify">
                    A tutorial video could be viewed <a href="https://www.youtube.com/watch?v=Fh4pkoCx0fw">here</a>.
                </p>
            </div>
        </div>

        <div style="display:none">
            <div id='inlineworkflowreporthelp' style='padding:10px; background:#fff'>
                <h5>Workflow Report</h5>
                <p align="justify">
                    A Workflow reports consists of snapshots of each application when workflow execution has finished.
                    A sample report looks like the following and a video tutorial can be found <a href="https://www.youtube.com/watch?v=qX0n29G5ZGg">here</a>.

                </p>
                <p align="justify">
                    <img align="left" height="500px" width="700px" src="/static/images/workflowreport.png" />
                </p>
            </div>
        </div>
        <div style="display:none">
            <div id="inlinebroadcastdatatype" style='padding:10px; background:#fff'>
                <h5>Broadcast Data Type</h5>
                <p align="justify">
                    If you are opening a list of gene names (e.g., {DVU2025, DVU2028, DVU3038}, select "Namelist".
                    If you are opening a file that contains a list of gene names, select "File".
                </p>
            </div>
        </div>
        <div id="dlgSaveState" style="display: none">
            <p>Name: <input type="text" /></p>
            <p>Description: <input type="text" /></p>
        </div>

        <input id="inputDataSignal" type="hidden" value="0" />

    </div>

    <div id="tab-states">
        <div class="sub-page">
            <br />
            <div style="width: 100px; float: left">
                <a id="btnSaveState" class="small green awesome" href='javascript:SaveState();' title="Save current state of the work">Save State</a>
            </div>
            <div style="margin-left: 100px">
                <a class="componenthelp" align="right" href="#inlinesavestatehelp">
                    <img src="/static/images/help.png" />
                </a>
            </div>
            <table id="tblSavedStates" class="tblDataSpace"><caption> Saved Analysis States&nbsp;&nbsp;<label id="lblSaveStateWarning" class="lblWarning">Saving state...</label></caption>
                <tbody>
                <tr>
                    <th style="width:20%">
                        <div class="componentheader">Name</div>
                    </th>
                    <th>Description</th>
                    <th>Date</th>
                    <th>Files</th>
                    <th>Operations</th>
                </tr>

                {% for stateentry in stateentries %}
                    <tr>
                        <td style="width:20%">
                            <p id='astate_{{state.id|stringformat:"i"}}'>{{stateentry.state.name}}</p>
                            <input type="hidden" value='{{stateentry.state.id|stringformat:"i"}}' />
                        </td>
                        <td> {{stateentry.state.description}} </td>
                        <td> {{stateentry.state.created_datetime}} </td>
                        <td>
                            <select class="selStateFiles" multiple>
                                {% for statefile in stateentry.statefiles %}
                                    <option value="{{statefile.id}}" title="{{statefile.name}}">{{statefile.name}}</option>
                                {% endfor %}
                            </select>
                        </td>
                        <td><!--<span id="boss"  class="boss"><a href='/static/jnlp/boss.jnlp' title="First start Gaggle Boss">start Gaggle boss</a></span>-->
                            <input type="button" value="Load" class="button" onclick="javascript:LoadState(this);" />
                            <input type="button" value="Edit" class="button" onclick="javascript:EditState(this);" />
                            <input type="button" value="Delete" class="button" onclick="javascript:DeleteState(this);" />
                            <br />
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        </div>
    </div>

    <div id="tab-reports">
        <div class="sub-page">
            <div><H3> Reports</H3>
                <table id="tblReport">
                    <caption>
                        <div style="width: 290x; float: left; margin-top: 10px">
                            Workflow Reports - <a href="javascript:DeleteSessionReport();">Delete Selected</a>
                        </div>
                        <div style="margin-left: 295px" align="center">
                            <a class="componenthelp" href="#inlineworkflowreporthelp">
                                <img src="/static/images/help.png" />
                            </a>
                        </div>
                    </caption>
                    <th>Name</th>
                    <!--<th>Description</th> -->
                    <th>Workflow</th>
                    <th>Date</th>
                    <th>Operations</th>
                </table>
            </div>
            <br />
        </div>
    </div>

    <div id="tab-history">
        <div class="sub-page">
            <div><H3> History</H3>
                <div id="divHistoryInfo" class="autoscrolldiv">
                </div>
                <br/>
                <input type="button" value="Clear" onclick="javascript:ClearHistory('#divHistoryInfo');" />
            </div>
        </div>
    </div>

    <div id="tab-log">
        <div class="sub-page">
            <div><H3>Log</H3>
                <div id="divLogInfo" class="autoscrolldiv">
                </div>
                <br/>
                <input type="button" value="Clear" onclick="javascript:ClearHistory('#divLogInfo');" />
            </div>
        </div>
    </div>
    


</div>
</div>


</div>


<div>
    <applet id="GaggleProxy" archive="{{ STATIC_PREFIX }}lib/GaggleProxy.jar, {{ STATIC_PREFIX }}lib/gaggle-connector.jar, {{ STATIC_PREFIX }}lib/boss.jar" code="org.systemsbiology.gaggle.geese.proxygoose.GaggleProxyApplet.class" width="0" height="0">
    </applet>

    <!-- <input type="text" id="htmlLoader" />
  <input type="button" value="Load" onclick="LoadHTML()" />
  <input type="button" value="Filter" onclick="FilterHTML()" />
  <div id="divHTMLResult"></div> -->

</div>
<input id="inputFiregoose" type="hidden" value="" />
<input id="inputFiregooseBossStart" type="hidden" value="" />
</div>

{% endblock %}
