<div class="main">
  <script>
    $(document).ready(function() {

    $("#bicluster-functions-table")
    .tablesorter({widthFixed: true, widgets: ['zebra']})
    {#.tablesorterPager({container: $("#tablepager")})#};

    $("#cog-functions-table")
    .tablesorter({widthFixed: true, widgets: ['zebra']})
    {#.tablesorterPager({container: $("#tablepager")})#};

    $("#go-functions-table")
    .tablesorter({widthFixed: true, widgets: ['zebra']})
    {#.tablesorterPager({container: $("#tablepager")})#};

    $("#tigr-functions-table")
    .tablesorter({widthFixed: true, widgets: ['zebra']})
    {#.tablesorterPager({container: $("#tablepager")})#};

    });
  </script>

  <h3> Functional Enrichment</h3>
  <p>
    <b>Regulon {{ bicluster.id }}</b> is enriched for following functions.
  </p> 


  <p class="table-top"><a class="link-desc">Jump to</a> | <a class="table-link" href="#kegg"> KEGG </a> | <a class="table-link" href="#go"> GO </a> | <a class="table-link" href="#tigr"> TIGRFam </a> | <a class="table-link" href="#cog"> COG </a></p>

  <!-- KEGG Table -->
  <a name="kegg"></a>
  <table id="bicluster-functions-table" class="tablesorter">
    <caption>KEGG Enrichment Table <span class="search_help">(Click on a column name to sort)</span></caption>
    <thead>
      <tr>
        <th>Function Name</th>
        <th>Function Type</th>
        <th>Unadjusted pvalue</th>
        <th>Benjamini Hochberg pvalue</th>
        <th>Genes with function</th>
        <th>Method</th>
      </tr>
    </thead>
    <tbody>
      {% for s in bicluster_functions %}{% if s.function.type == "kegg" %}{% if s.p_bh < 0.05 %}{% if s.gene_count > 2 %}
      <tr>
        <td><a href="/function/{{ s.function.id }}">{{ s.function.name }}</a></td>
        <td>{{ s.function.namespace }}</td>
        <td>{{ s.p }}</td>
        <td>{{ s.p_bh }}</td>
        <td>{{ s.gene_count }}/{{ gene_count }}</td>
        <td>{{ s.method }}</td>
      </tr>
      {% endif %}{% endif %}{% endif %}{% endfor %}
    </tbody>
  </table>

  <a name="go"></a>
  <table id="go-functions-table" class="tablesorter">
    <caption>GO Enrichment Table <span class="search_help">(Click on a column name to sort)</span></caption>
    <thead>
      <tr>
        <th>Function Name</th>
        <th>Function Type</th>
        <th>Unadjusted pvalue</th>
        <th>Benjamini& Hochberg pvalue</th>
        <th>Genes with function</th>
        <th>Method</th>
      </tr>
    </thead>
    <tbody>
      {% for s in bicluster_functions %}{% if s.function.type == "go" %}{% if s.p_bh < 0.05 %}{% if s.gene_count > 2 %}
      <tr>
        <td><a href="/function/{{ s.function.id }}">{{ s.function.name }}</a></td>
        <td>{{ s.function.namespace }}</td>
        <td>{{ s.p }}</td>
        <td>{{ s.p_bh }}</td>
        <td>{{ s.gene_count }}/{{ gene_count }}</td>
        <td>{{ s.method }}</td>
        </tr>{% endif %}{% endif %}{% endif %}{% endfor %}
    </tbody>
  </table>

  <a name="tigr"></a>
  <table id="tigr-functions-table" class="tablesorter">
    <caption>TIGRFam Enrichment Table <span class="search_help">(Click on a column name to sort)</span></caption>
    <thead>
      <tr>
        <th>Function Name</th>
        <th>Function Type</th>
        <th>Unadjusted pvalue</th>
        <th>Benjamini& Hochberg pvalue</th>
        <th>Genes with function</th>
        <th>Method</th>
      </tr>
    </thead>
    <tbody>
      {% for s in bicluster_functions %}{% if s.function.type == "tigr" %}{% if s.p_bh < 0.05 %}{% if s.gene_count > 2 %}
      <tr>
        <td><a href="/function/{{ s.function.id }}">{{ s.function.name }}</a></td>
        <td>{{ s.function.namespace }}</td>
        <td>{{ s.p }}</td>
        <td>{{ s.p_bh }}</td>
        <td>{{ s.gene_count }}/{{ gene_count }}</td>
        <td>{{ s.method }}</td>
        </tr>{% endif %}{% endif %}{% endif %}{% endfor %}
    </tbody>
  </table>

  <a name="cog"></a>
  <table id="cog-functions-table" class="tablesorter">
    <caption>COG Enrichment Table <span class="search_help">(Click on a column name to sort)</span></caption>
    <thead>
      <tr>
        <th>Function Name</th>
        <th>Function Type</th>
        <th>Unadjusted pvalue</th>
        <th>Benjamini& Hochberg pvalue</th>
        <th>Genes with function</th>
        <th>Method</th>
      </tr>
    </thead>
    <tbody>
      {% for s in bicluster_functions %}{% if s.function.type == "cog" %}{% if s.p_bh < 0.05 %}{% if s.gene_count > 2 %}
      <tr>
        <td><a href="/function/{{s.function.id}}">{{ s.function.name }}</a></td>
        <td>{{ s.function.namespace }}</td>
        <td>{{ s.p }}</td>
        <td>{{ s.p_bh }}</td>
        <td>{{ s.gene_count }}/{{ gene_count }}</td>
        <td>{{ s.method }}</td>
        </tr>{% endif %}{% endif %}{% endif %}{% endfor %}
    </tbody>
  </table>
</div>
